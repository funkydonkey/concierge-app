# iOS Shortcuts - Пошаговая Инструкция

## Быстрый старт

Этот шорткат записывает голосовую заметку и отправляет её на сервер для обработки.

## Шаг 1: Создание нового шортката

1. Откройте приложение **Shortcuts** (Команды)
2. Нажмите **"+"** в правом верхнем углу
3. Нажмите **"Add Action"** (Добавить действие)

## Шаг 2: Добавление действий

### Действие 1: Record Audio (Запись аудио)

```
В поиске введите: Record Audio
Выберите: Record Audio
```

**Настройка:**
- По умолчанию: "Until You Tap Stop" (Пока не нажмёте стоп)
- Или установите таймер: "For 1 minute" и т.д.

**Что делает:** Записывает голосовую заметку

---

### Действие 2: Get Contents of URL (Получить содержимое URL)

```
В поиске введите: Get Contents of URL
Выберите: Get Contents of URL
```

**Настройка:**

1. **URL**: Введите адрес вашего сервера
   ```
   https://your-app.onrender.com/api/voice
   ```

2. Нажмите **"Show More"** (Показать больше)

3. **Method** (Метод): Выберите `POST`

4. **Request Body** (Тело запроса): Выберите `Form`

5. Нажмите **"Add new field"** (Добавить поле):
   - **Text** (верхнее поле): Введите `audio`
   - **Value** (нижнее поле):
     - Нажмите на поле
     - В появившемся меню выберите "Recorded Audio" (из предыдущего действия)
     - Иконка изменится на документ/файл

**Что делает:** Отправляет аудио на сервер

---

### Действие 3: Get Dictionary Value (Получить значение из словаря)

```
В поиске введите: Get Dictionary Value
Выберите: Get Dictionary Value
```

**Настройка:**
- **Get**: Оставьте "Value"
- **for**: Введите `transcription`
- **in**: Должно быть "Contents of URL" (автоматически)

**Что делает:** Извлекает текст транскрипции из ответа сервера

---

### Действие 4: Show Notification (Показать уведомление)

```
В поиске введите: Show Notification
Выберите: Show Notification
```

**Настройка:**
- Нажмите на поле текста
- Выберите "Dictionary Value" из предыдущего действия

**Что делает:** Показывает уведомление с транскрипцией

---

## Шаг 3: Сохранение и именование

1. Нажмите **"Done"** (Готово) в правом верхнем углу
2. Введите имя шортката: `Voice to Obsidian` или `Голосовая заметка`
3. Нажмите **"Done"**

## Шаг 4: Добавление на главный экран (опционально)

1. Найдите созданный шорткат в списке
2. Нажмите на **"..."** (три точки)
3. Нажмите на иконку настроек (⋮) в правом верхнем углу
4. Выберите **"Add to Home Screen"** (Добавить на главный экран)
5. Настройте:
   - Имя (будет под иконкой)
   - Иконку (цвет и символ)
6. Нажмите **"Add"**

## Использование

### Вариант 1: Из приложения Shortcuts
1. Откройте Shortcuts
2. Нажмите на ваш шорткат
3. Разрешите доступ к микрофону (первый раз)
4. Запишите сообщение
5. Нажмите "Stop" когда закончите
6. Дождитесь уведомления с транскрипцией

### Вариант 2: С главного экрана
1. Нажмите на иконку шортката
2. Запишите сообщение
3. Нажмите "Stop"
4. Готово!

### Вариант 3: Через Siri
1. Скажите: "Hey Siri, Voice to Obsidian"
2. Запишите сообщение
3. Скажите "Stop" или нажмите кнопку

## Примеры использования

### TODO задача
```
Запись: "Нужно купить молоко и хлеб завтра утром"
Результат: Задача добавлена в TODO.md с приоритетом medium
```

### Идея
```
Запись: "Идея для приложения - трекер привычек с геймификацией"
Результат: Заметка создана в папке Ideas/
```

### Рабочая заметка
```
Запись: "Встреча с клиентом обсудили новый дизайн нужно сделать прототип"
Результат: Заметка в Work/ + задача в TODO
```

## Устранение проблем

### Шорткат не запускается
- ✅ Проверьте доступ к микрофону: Settings → Privacy → Microphone → Shortcuts
- ✅ Разрешите доступ к сети: Settings → Privacy → Local Network

### "Network Error"
- ✅ URL правильный? (https://your-app.onrender.com/api/voice)
- ✅ Сервер работает? Проверьте в браузере: https://your-app.onrender.com/api/health
- ✅ WiFi/сотовая сеть включена?

### "The operation couldn't be completed"
- ✅ В "Get Contents of URL" выбрано Request Body = Form?
- ✅ Поле "audio" добавлено?
- ✅ В поле "audio" выбрано "Recorded Audio"?

### Транскрипция неточная
- ✅ Говорите четче и медленнее
- ✅ Минимизируйте фоновый шум
- ✅ Держите телефон ближе ко рту

### Заметки не появляются в Obsidian
- ✅ Проверьте GitHub репозиторий - файлы там есть?
- ✅ Obsidian Git plugin установлен и настроен?
- ✅ Auto-pull включен? (Settings → Obsidian Git → Auto-pull)
- ✅ Подождите 5 минут (интервал синхронизации)

## Упрощенная версия (без уведомлений)

Если уведомления не нужны, создайте шорткат только из 2 действий:

1. **Record Audio** - записывает аудио
2. **Get Contents of URL** - отправляет на сервер

Всё! Заметки будут создаваться автоматически без уведомлений.

## Продвинутые настройки

### Автоматическая запись без нажатий
В "Record Audio" можно установить:
- "For 30 Seconds" - автостоп через 30 секунд
- "For 1 Minute" - автостоп через минуту

### Добавление заголовков (Headers)
В "Get Contents of URL" → "Show More" → "Headers":
- Можно добавить Authorization если защитите API
- Можно добавить кастомные метаданные

### Обработка ошибок
Добавьте после "Get Contents of URL":

```
If (Contents of URL > has any value)
  Then: [показать успех]
  Otherwise: [показать ошибку]
```

## Альтернативные сценарии

### Быстрая заметка без остановки
```
1. Record Audio (For 30 Seconds)
2. Get Contents of URL
```

### С выбором папки
Можно добавить "Choose from Menu" перед отправкой:
- Ideas
- Work
- Personal

И менять URL параметры соответственно.

### Пакетная обработка
Можно записать несколько заметок подряд:
```
1. Repeat 5 times
   - Record Audio
   - Get Contents of URL
```

## Полезные советы

1. **Говорите структурировано**: "Задача: купить молоко. Идея: новое приложение."
2. **Используйте ключевые слова**: "Нужно", "Идея", "Не забыть"
3. **Указывайте сроки**: "Завтра", "В пятницу", "До конца недели"
4. **Проверяйте первые заметки**: Убедитесь что AI правильно классифицирует контент

## Дополнительно

### Виджет на главном экране
iOS 14+: Можно добавить виджет Shortcuts на главный экран для быстрого доступа.

### Back Tap (удар по задней панели)
Settings → Accessibility → Touch → Back Tap:
- Double Tap → Voice to Obsidian
- Triple Tap → [другой шорткат]

### Automation (автоматизация)
Settings → Shortcuts → Automation:
- Запуск в определенное время
- Запуск при подключении к WiFi
- Запуск при открытии приложения

---

**Готово!** Теперь у вас есть полностью рабочий шорткат для записи голосовых заметок с автоматической транскрипцией и сохранением в Obsidian через GitHub.
